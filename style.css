:root{
  --bg:#ffeec9;
  --card:#fff7e6;
  --stroke:#f5d3a6;
  --ink:#4b3044;
  --muted:#7a5a6a;
  --shadow:0 8px 18px rgba(0,0,0,0.14);

  --wolf:#c0392b;
  --wolfSoft:rgba(192,57,43,0.15);
  --good:#2c6ec0;
  --goodSoft:rgba(44,110,192,0.14);

  --sel:#ffd36a;
  --selStroke:#f1a93a;

  --dead:#c9c1c7;

  --radius:18px;
  --radiusSm:14px;

  --btn:#f4a63a;
  --btnInk:#4b3044;

  --dockH:64px; /* 底部三顆按鈕高度（縮小版） */
  --topH:54px;  /* 頂部列高度（縮小版） */
}

/* ====== iOS 防選取 / 防放大（CSS 端） ====== */
*{
  box-sizing:border-box;
  -webkit-tap-highlight-color: transparent;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  user-select: none;
}
html,body{
  height:100%;
  margin:0;
  padding:0;
  background:var(--bg);
  font-family:"Noto Sans TC",-apple-system,BlinkMacSystemFont,sans-serif;
  color:var(--ink);
  overscroll-behavior: none;
  touch-action: manipulation; /* 降低雙擊放大機率 */
}
body{
  overflow:hidden; /* ✅ 禁止整頁滾動，改為內部區塊滾動 */
}

pre{
  margin:0;
  white-space:pre-wrap;
  word-break:break-word;
}

/* ====== Layout ====== */
.app{
  max-width:480px;
  height:100vh;
  margin:0 auto;
  position:relative;
  padding-bottom: calc(var(--dockH) + env(safe-area-inset-bottom));
}

/* Top bar */
.top{
  position:sticky;
  top:0;
  z-index:20;
  height:var(--topH);
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:8px 10px;
  background:linear-gradient(#ffeec9, rgba(255,238,201,0.92));
  border-bottom:1px solid rgba(0,0,0,0.05);
}

.topLeft{
  min-width:0;
}
.uiStatus{
  font-weight:900;
  font-size:13px;
  line-height:1.1;
}
.uiBoard{
  font-size:11px;
  color:var(--muted);
  line-height:1.1;
  margin-top:2px;
  max-width:240px;
  overflow:hidden;
  text-overflow:ellipsis;
  white-space:nowrap;
}

.topRight{
  display:flex;
  gap:6px;
  align-items:center;
}

.iconBtn{
  width:34px;
  height:34px;
  border-radius:12px;
  border:2px solid var(--stroke);
  background:var(--card);
  box-shadow: 0 4px 10px rgba(0,0,0,0.12);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:16px;
  padding:0;
}
.iconBtn:active{
  transform: translateY(1px);
}

/* Main area */
.main{
  height: calc(100vh - var(--topH) - var(--dockH) - env(safe-area-inset-bottom));
  padding:10px 10px 10px;
  display:flex;
  flex-direction:column;
  gap:10px;
  overflow:hidden; /* ✅ main 不滾，子區塊滾 */
}

/* Cards */
.card{
  background:var(--card);
  border:2px solid var(--stroke);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:10px 10px 12px;
}
.card.tight{ padding:10px; }
.cardTitle{
  font-weight:900;
  font-size:16px;
  margin:0 0 6px;
}
.hint{
  font-size:12px;
  color:var(--muted);
}
.row{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
}
.cardFoot{
  margin-top:8px;
}

/* Prompt card: 佔上半 */
.promptCard{
  flex: 0 0 auto;
}
.cardText.scrollBox{
  max-height: 120px; /* ✅ 不佔太多，留空間給座位 */
  overflow:auto;
  padding:8px 10px;
  border-radius:14px;
  border:1px dashed rgba(0,0,0,0.15);
  background: rgba(255,255,255,0.45);
  font-size:13px;
  line-height:1.55;
}

/* Setup card：允許內部滾動，避免板子被切到 */
.setupCard{
  flex: 0 0 auto;
}
.setupCard .chips{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}

.chip{
  border:2px solid var(--stroke);
  background:#fff;
  color:var(--ink);
  border-radius:999px;
  padding:7px 12px;
  font-weight:800;
  font-size:13px;
}
.chip.primary,
.chip.active{
  background: var(--sel);
  border-color: var(--selStroke);
}
.chip:active{ transform: translateY(1px); }

/* 板子格子按鈕：清楚分格 + 會變色 */
.boardList{
  display:grid;
  grid-template-columns: 1fr;
  gap:8px;
  max-height: 210px;     /* ✅ 可滑，避免被切到 */
  overflow:auto;
  padding-right:2px;
}
.boardBtn{
  width:100%;
  text-align:left;
  padding:10px 12px;
  border-radius:14px;
  border:2px solid var(--stroke);
  background:#fff;
  font-weight:900;
  color:var(--ink);
  box-shadow: 0 4px 10px rgba(0,0,0,0.10);
}
.boardBtn.active{
  background: var(--sel);
  border-color: var(--selStroke);
}
.boardBtn:active{
  transform: translateY(1px);
}

/* Seats header */
.seatsHeader{
  flex: 0 0 auto;
}

/* Seats grid：你喜歡的原本樣式（格子） */
.seatsGrid{
  flex: 1 1 auto;
  overflow:auto; /* ✅ 座位可滑動，不會被底部擋住 */
  padding-bottom: 10px;
  display:grid;
  grid-template-columns: repeat(4, 1fr); /* 12人 = 3列*4欄 */
  gap:10px;
}

/* Seat button */
.seat{
  position:relative;
  border-radius:16px;
  border:2px solid var(--stroke);
  background:#fff;
  box-shadow: 0 6px 14px rgba(0,0,0,0.12);
  height: 64px;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:0;
}
.seatNum{
  font-weight:1000;
  font-size:20px;
}
.seat.selected{
  background: var(--sel);
  border-color: var(--selStroke);
  box-shadow: 0 8px 16px rgba(241,169,58,0.35);
}
.seat.dead{
  opacity:0.55;
  filter: grayscale(0.2);
}

/* 上帝視角：依陣營框色 */
.seat.campWolf{
  border-color: var(--wolf);
  box-shadow: 0 8px 16px rgba(192,57,43,0.20);
}
.seat.campGood{
  border-color: var(--good);
  box-shadow: 0 8px 16px rgba(44,110,192,0.18);
}

/* 角色簡寫徽章 */
.seatBadge{
  position:absolute;
  left:6px;
  top:6px;
  font-size:12px;
  font-weight:1000;
  border-radius:10px;
  padding:2px 6px;
  border:1px solid rgba(0,0,0,0.12);
  background: rgba(255,255,255,0.78);
}

/* 事件圖示（死亡/藥/盾） */
.seatEvents{
  position:absolute;
  right:6px;
  bottom:6px;
  font-size:14px;
  opacity:0.95;
}

/* Bottom bar (3 buttons) */
.bottomBar{
  position:fixed;
  left:50%;
  transform:translateX(-50%);
  bottom:0;
  width:min(480px, 100%);
  height: calc(var(--dockH) + env(safe-area-inset-bottom));
  padding:8px 10px calc(8px + env(safe-area-inset-bottom));
  background:linear-gradient(rgba(255,238,201,0.75), rgba(255,238,201,0.98));
  border-top:1px solid rgba(0,0,0,0.06);
  display:grid;
  grid-template-columns: 1fr 1.15fr 1fr;
  gap:8px;
  z-index:30;
}

/* Buttons */
.btn{
  border:none;
  border-radius:14px;
  padding:10px 10px;
  font-weight:1000;
  font-size:14px;   /* ✅ 縮小 */
  background: var(--btn);
  color: var(--btnInk);
  box-shadow: 0 6px 14px rgba(0,0,0,0.14);
}
.btn:active{ transform: translateY(1px); }

.btn.ghost{
  background:#fff;
  border:2px solid var(--stroke);
  box-shadow: 0 4px 12px rgba(0,0,0,0.10);
}
.btn.main{
  font-size:14px; /* 中間重要流程按鈕，但不再巨大 */
}
.btn:disabled{
  opacity:0.55;
  filter: grayscale(0.1);
}

/* Drawer / Backdrop */
.backdrop{
  position:fixed;
  inset:0;
  background: rgba(0,0,0,0.35);
  z-index:50;
}
.hidden{ display:none !important; }

.drawer{
  position:fixed;
  left:50%;
  transform:translateX(-50%);
  bottom:0;
  width:min(480px, 100%);
  max-height: 82vh;
  background: var(--card);
  border:2px solid var(--stroke);
  border-bottom:none;
  border-radius: 18px 18px 0 0;
  box-shadow: 0 -10px 28px rgba(0,0,0,0.25);
  z-index:60;
  overflow:hidden;
}
.drawerTop{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:10px 12px;
  border-bottom:1px solid rgba(0,0,0,0.06);
}
.drawerTitle{
  font-weight:1000;
  font-size:16px;
}
.drawerBody{
  padding:12px;
  overflow:auto;
  max-height: calc(82vh - 52px);
}

/* Seg */
.seg{
  display:grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap:8px;
}
.segBtn{
  padding:10px 10px;
  border-radius:14px;
  border:2px solid var(--stroke);
  background:#fff;
  font-weight:1000;
}
.segBtn.active,
.segBtn.primary{
  background: var(--sel);
  border-color: var(--selStroke);
}

/* Modal */
.modal{
  position:fixed;
  inset:0;
  background: rgba(0,0,0,0.38);
  z-index:80;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:16px;
}
.modalCard{
  width:min(460px, 100%);
  background: var(--card);
  border:2px solid var(--stroke);
  border-radius:18px;
  box-shadow: 0 16px 34px rgba(0,0,0,0.30);
  padding:12px;
}
.modalTitle{
  font-weight:1000;
  font-size:18px;
}
.modalBody{
  margin-top:10px;
}
.roleLine{
  font-weight:1000;
  font-size:16px;
}
.roleLine.small{
  margin-top:6px;
  font-size:13px;
  color:var(--muted);
}
.modalActions{
  display:flex;
  gap:8px;
  margin-top:12px;
}

/* Dice */
.diceResult{
  font-size:30px;
  font-weight:1000;
  text-align:center;
  padding:10px 0;
}

/* Mini card in thief modal */
.card.mini{
  background: rgba(255,255,255,0.55);
  border:1px dashed rgba(0,0,0,0.18);
  border-radius:14px;
  padding:10px;
}