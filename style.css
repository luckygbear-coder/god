/* =========================================================
   狼人殺｜上帝輔助 PWA（重新設計 UI v1）
   style.css

   目標：
   - 手機不捲軸即可操作（App Shell 固定高度）
   - 童話桌遊 UI（奶油底、卡片、圓角、陰影）
   - iOS 長按不選字、不放大（CSS 層）
   - 座位圓點一致、可點、可高亮、死亡灰化
   - 彈窗 + 翻牌動畫
========================================================= */

/* ========== Reset / Base ========== */
* { box-sizing: border-box; }
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
}

:root{
  --bg: #ffeec9;
  --shell: #fff7e6;
  --card: #ffffff;
  --cream: #fff7e6;
  --brown: #5a3b2e;
  --brown2:#7a533d;
  --line:#e9caa2;

  --accent:#f4a63a;
  --accent2:#ff7b6b;
  --ok:#25a46a;
  --warn:#d85c4a;

  --shadow: 0 8px 20px rgba(0,0,0,.18);
  --shadow2: 0 3px 10px rgba(0,0,0,.12);

  --r12: 12px;
  --r16: 16px;
  --r20: 20px;

  --tap: rgba(244,166,58,.18);
}

/* iOS: avoid zoom on inputs */
input, button, textarea, select {
  font-size: 16px;
}

/* Prevent text selection & callout */
body{
  background: var(--bg);
  color: var(--brown);
  font-family: "Noto Sans TC", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;

  /* no scroll overall */
  overflow: hidden;

  /* prevent selection/callout */
  -webkit-user-select: none;
  user-select: none;
  -webkit-touch-callout: none;
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}

/* Allow select inside certain text areas only */
pre, .annbox, .logtext {
  -webkit-user-select: text;
  user-select: text;
}

/* ========== App Shell ========== */
.app-shell{
  height: 100%;
  max-width: 520px;
  margin: 0 auto;
  display: flex;
  flex-direction: column;

  background: var(--shell);
  box-shadow: var(--shadow);
  position: relative;
}

/* ========== Topbar ========== */
.topbar{
  flex: 0 0 auto;
  padding: 12px 14px 10px;
  display: flex;
  align-items: center;
  justify-content: space-between;

  background: linear-gradient(180deg, #fff2d6, #ffe8b6);
  border-bottom: 2px solid var(--line);
}

.brand-title{
  font-weight: 1000;
  letter-spacing: .3px;
}
.brand-sub{
  font-size: 12px;
  opacity: .75;
  margin-top: 2px;
}

.top-actions{
  display: flex;
  gap: 8px;
}

/* ========== Main ========== */
.main{
  flex: 1 1 auto;
  position: relative;
  overflow: hidden;
}

/* ========== Screen (no scroll) ========== */
.screen{
  height: 100%;
  display: none;
  flex-direction: column;
  padding: 12px 12px 88px; /* reserve for bottombar */
  overflow: hidden;
}
.screen.active{
  display: flex;
}

/* card container can scroll internally if needed */
.card{
  background: var(--card);
  border-radius: var(--r16);
  border: 2px solid #f1d6b4;
  box-shadow: var(--shadow2);
  padding: 14px;
  overflow: hidden;
}

.card.inner{
  margin-top: 12px;
  background: var(--cream);
}

h1,h2,h3{
  margin: 0 0 10px;
  color: var(--brown);
}
h2{ font-size: 18px; }

/* ========== Rows / Layout helpers ========== */
.row{
  display: flex;
  align-items: center;
  gap: 10px;
}
.row.spread{ justify-content: space-between; }
.row.wrap{ flex-wrap: wrap; }

.label{
  font-weight: 900;
  margin-bottom: 6px;
}
.hint{
  font-size: 12px;
  opacity: .78;
  line-height: 1.45;
}
.hint.small{ font-size: 11px; opacity: .7; }
.warn{
  margin-top: 10px;
  padding: 10px 12px;
  background: rgba(216,92,74,.10);
  border: 2px solid rgba(216,92,74,.25);
  border-radius: 12px;
  color: #8b2f22;
  font-weight: 800;
}
.hidden{ display: none !important; }

/* ========== Big number ========== */
.big-num{
  font-weight: 1000;
  font-size: 26px;
  min-width: 60px;
  text-align: center;
}

/* ========== Pills / Tags ========== */
.pill{
  padding: 8px 12px;
  border-radius: 999px;
  border: 2px solid rgba(0,0,0,.10);
  background: #fff;
  font-weight: 900;
}
.pill.active{
  background: rgba(244,166,58,.18);
  border-color: rgba(244,166,58,.55);
}

.tag{
  font-size: 12px;
  font-weight: 900;
  padding: 6px 10px;
  border-radius: 999px;
  background: rgba(0,0,0,.06);
}

/* ========== Buttons ========== */
.btn{
  border: none;
  border-radius: 14px;
  padding: 12px 14px;
  font-weight: 950;
  background: var(--accent);
  color: #3b2318;
  box-shadow: 0 6px 0 rgba(0,0,0,.12);
}
.btn:active{
  transform: translateY(1px);
  box-shadow: 0 4px 0 rgba(0,0,0,.12);
}
.btn.primary{
  background: linear-gradient(180deg, #ffbe53, var(--accent));
}
.btn.ghost{
  background: #fff;
  border: 2px solid rgba(0,0,0,.12);
  box-shadow: none;
}
.btn.tiny{
  padding: 8px 10px;
  border-radius: 12px;
  font-weight: 900;
}
.btn:disabled{
  opacity: .5;
  box-shadow: none;
}

/* Icon button */
.iconbtn{
  border: 2px solid rgba(0,0,0,.10);
  background: #fff;
  border-radius: 14px;
  padding: 10px 10px;
  font-size: 16px;
}
.iconbtn:active{
  background: var(--tap);
}

/* ========== Range ========== */
.range{
  width: 100%;
  margin-top: 10px;
}

/* ========== Bottom bar (fixed inside shell) ========== */
.bottombar{
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;

  padding: 12px;
  background: linear-gradient(180deg, rgba(255,247,230,0), rgba(255,247,230,1) 40%);
  border-top: 1px solid rgba(0,0,0,.05);
}
.bottombar .btn{
  width: 100%;
}

/* ========== Deal Area ========== */
.deal-area{
  margin: 14px 0;
}
.hold-btn{
  width: 100%;
  padding: 18px 14px;
  border-radius: 18px;
  border: 2px dashed rgba(0,0,0,.18);
  background: #fff;
  font-weight: 1000;
  line-height: 1.3;
}
.hold-btn:active{
  background: var(--tap);
}

/* Seat dots area (deal and others) */
.seats{
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-top: 10px;
}

/* ========== Seat dot ========== */
.seat{
  width: 46px;
  height: 46px;
  border-radius: 999px;
  border: 2px solid rgba(0,0,0,.14);
  background: #fff;
  font-weight: 1000;
  display: grid;
  place-items: center;
  box-shadow: 0 4px 0 rgba(0,0,0,.08);
}
.seat:active{
  background: var(--tap);
}
.seat.selected{
  border-color: rgba(244,166,58,.85);
  box-shadow: 0 0 0 4px rgba(244,166,58,.18);
}
.seat.dead{
  background: rgba(0,0,0,.10);
  border-color: rgba(0,0,0,.12);
  opacity: .55;
  box-shadow: none;
}
.seat.ghost{
  width: auto;
  padding: 0 14px;
  height: 46px;
  border-radius: 999px;
}

/* ========== Ann box ========== */
.annbox{
  white-space: pre-wrap;
  margin: 0;
  padding: 12px;
  border-radius: 14px;
  background: #fff;
  border: 2px solid rgba(0,0,0,.08);
  max-height: 46vh;
  overflow: auto;
}

/* ========== FAB ========== */
.fab{
  position: absolute;
  right: 14px;
  bottom: 94px; /* above bottom bar */
  display: flex;
  flex-direction: column;
  gap: 10px;
}
.fab button{
  width: 52px;
  height: 52px;
  border-radius: 999px;
  border: 2px solid rgba(0,0,0,.10);
  background: #fff;
  font-size: 18px;
  box-shadow: var(--shadow2);
}
.fab button:active{
  background: var(--tap);
}

/* ========== Modal ========== */
.modal{
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,.45);
  display: grid;
  place-items: center;
  padding: 14px;
  z-index: 50;
}
.modal.hidden{ display:none !important; }

.modal-card{
  width: 100%;
  max-width: 520px;
  background: var(--shell);
  border-radius: 18px;
  border: 2px solid rgba(255,255,255,.25);
  box-shadow: var(--shadow);
  overflow: hidden;
}
.modal-head{
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 12px;
  background: linear-gradient(180deg, #fff2d6, #ffe8b6);
  border-bottom: 2px solid var(--line);
}
.modal-title{
  font-weight: 1000;
}
.modal-body{
  padding: 12px;
}
.modal-actions{
  padding: 12px;
  display: flex;
  gap: 10px;
  justify-content: flex-end;
}

/* ========== Flip Card (Reveal) ========== */
.reveal-wrap{
  perspective: 900px;
}
.reveal-card{
  width: 100%;
  max-width: 360px;
  margin: 0 auto;
  height: 220px;
  position: relative;
  transform-style: preserve-3d;
  transition: transform .5s ease;
}
.reveal-card.flipped{
  transform: rotateY(180deg);
}

.reveal-face{
  position: absolute;
  inset: 0;
  border-radius: 18px;
  backface-visibility: hidden;
  border: 2px solid rgba(0,0,0,.12);
  box-shadow: var(--shadow2);
  display: grid;
  place-items: center;
  padding: 14px;
}
.reveal-front{
  background: #fff;
}
.reveal-back{
  background: linear-gradient(180deg, #ffefc9, #fff7e6);
  transform: rotateY(180deg);
}
.reveal-icon{
  font-size: 42px;
}
.reveal-role{
  margin-top: 10px;
  font-weight: 1000;
  font-size: 20px;
}

/* ========== God mode visual ========== */
body.god-on .topbar{
  background: linear-gradient(180deg, #2b2230, #19121c);
  border-bottom-color: rgba(255,255,255,.08);
}
body.god-on .brand-title,
body.god-on .brand-sub{
  color: #fff;
}
body.god-on .app-shell{
  background: #1e1823;
}
body.god-on .card{
  background: #2a2330;
  border-color: rgba(255,255,255,.10);
  color: #f6e9ff;
}
body.god-on .card.inner{
  background: rgba(255,255,255,.06);
}
body.god-on .hint{ color: rgba(255,255,255,.78); opacity: 1; }
body.god-on .annbox{
  background: rgba(255,255,255,.06);
  border-color: rgba(255,255,255,.10);
  color: #f6e9ff;
}
body.god-on .iconbtn,
body.god-on .btn.ghost,
body.god-on .seat{
  background: rgba(255,255,255,.08);
  border-color: rgba(255,255,255,.18);
  color: #f6e9ff;
}
body.god-on .seat.dead{
  background: rgba(0,0,0,.25);
  border-color: rgba(255,255,255,.10);
}

/* ========== Role config rows ========== */
.role-row{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding: 10px 4px;
  border-bottom: 1px dashed rgba(0,0,0,.10);
}
.role-right{
  display:flex;
  align-items:center;
  gap: 10px;
}
.role-num{
  min-width: 32px;
  text-align:center;
  font-weight: 1000;
}

/* ========== Small fixes for mobile notch ========== */
@supports (padding: env(safe-area-inset-top)){
  .topbar{ padding-top: calc(12px + env(safe-area-inset-top)); }
  .bottombar{ padding-bottom: calc(12px + env(safe-area-inset-bottom)); }
  .fab{ bottom: calc(94px + env(safe-area-inset-bottom)); }
}