/* =========================
   Global / No Scroll Shell
========================= */
:root{
  --bg: #ffeec9;
  --card: #fff7e6;
  --ink: #3b2a3b;
  --muted:#6b5a6b;
  --line:#e1b676;
  --accent:#f4a63a;
  --accent2:#ff7b7b;
  --shadow: 0 10px 28px rgba(0,0,0,.18);
  --radius: 18px;
  --btnRadius: 16px;
  --safeB: env(safe-area-inset-bottom, 0px);
  --safeT: env(safe-area-inset-top, 0px);
}

*{ box-sizing:border-box; -webkit-tap-highlight-color: transparent; }
html,body{ height:100%; margin:0; padding:0; }
body{
  font-family: "Noto Sans TC", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: var(--bg);
  color: var(--ink);
  overflow: hidden; /* ‚úÖ ‰∏çÊç≤Ëª∏ */
  user-select: none;
  -webkit-user-select: none;
}

/* allow inputs */
input, textarea, pre{ user-select: text; -webkit-user-select: text; }

.hidden{ display:none !important; }

/* =========================
   App Shell Layout
========================= */
.app-shell{
  height: 100dvh;
  padding-top: var(--safeT);
  display:flex;
  flex-direction:column;
}

.topbar{
  flex: 0 0 auto;
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding: 12px 12px 10px;
}

.brand-title{
  font-weight: 1000;
  letter-spacing: .3px;
}
.brand-sub{
  font-size: 12px;
  color: var(--muted);
  margin-top: 2px;
}

.top-actions{
  display:flex;
  gap:10px;
  align-items:center;
}

.main{
  flex: 1 1 auto;
  min-height:0;
  position:relative;
  padding: 10px 12px calc(10px + var(--safeB));
}

/* =========================
   Screens
========================= */
.screen{
  position:absolute;
  inset: 10px 12px calc(10px + var(--safeB)) 12px;
  display:none;
  flex-direction:column;
  gap:10px;
}
.screen.active{ display:flex; }

.card{
  background: var(--card);
  border: 2px solid rgba(225,182,118,.7);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: 14px 14px;
  overflow:hidden;
}
.card.inner{
  box-shadow:none;
  border-style:dashed;
  background: rgba(255,255,255,.55);
  margin-top: 10px;
}
h2{ margin:0 0 10px; font-size: 18px; }
.label{ font-weight: 900; }
.hint{ color: var(--muted); font-size: 13px; line-height:1.5; }
.hint.small{ font-size: 12px; opacity:.9; margin-top:6px; }
.warn{
  margin-top:10px;
  background: rgba(255,123,123,.14);
  border: 1px solid rgba(255,123,123,.5);
  padding: 10px 12px;
  border-radius: 14px;
  font-weight: 900;
}

/* =========================
   Rows / Pills / Buttons
========================= */
.row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
.row.spread{ justify-content:space-between; }

.pill{
  border: 2px solid rgba(0,0,0,.12);
  background: rgba(255,255,255,.7);
  border-radius: 999px;
  padding: 8px 12px;
  font-weight: 900;
}
.pill.active{
  border-color: rgba(244,166,58,.75);
  background: rgba(244,166,58,.18);
}

.btn{
  border: 0;
  border-radius: var(--btnRadius);
  padding: 12px 14px;
  font-weight: 1000;
  background: rgba(244,166,58,.95);
  color: #2b1b2b;
  box-shadow: 0 6px 16px rgba(244,166,58,.22);
}
.btn:disabled{ opacity:.55; filter: grayscale(.2); }
.btn.ghost{
  background: rgba(255,255,255,.75);
  border: 2px solid rgba(0,0,0,.12);
  box-shadow:none;
}
.btn.primary{
  width:100%;
  padding: 14px 16px;
  font-size: 16px;
}
.btn.big{
  width:100%;
  padding: 16px 14px;
  font-size: 15px;
}
.btn.tiny{
  padding: 6px 10px;
  border-radius: 12px;
}

.iconbtn{
  width: 40px;
  height: 40px;
  border-radius: 14px;
  border: 2px solid rgba(0,0,0,.12);
  background: rgba(255,255,255,.75);
  font-size: 18px;
  font-weight: 900;
}

/* =========================
   Bottom Bar
========================= */
.bottombar{
  margin-top:auto;
  display:flex;
  gap:10px;
  align-items:center;
}

/* =========================
   Range / Numbers
========================= */
.big-num{
  font-size: 28px;
  font-weight: 1000;
  min-width: 56px;
  text-align:center;
}
.range{ width:100%; margin-top: 10px; }

/* =========================
   Deal
========================= */
.deal-area{ margin: 12px 0; }
.hold-btn{
  width:100%;
  padding: 20px 14px;
  border-radius: 22px;
  border: 2px dashed rgba(0,0,0,.16);
  background: rgba(255,255,255,.72);
  font-weight: 1000;
}

/* =========================
   Night Script
========================= */
.scriptbox{
  background: rgba(255,255,255,.65);
  border: 1px dashed rgba(0,0,0,.12);
  border-radius: 16px;
  padding: 12px 12px;
  white-space: pre-line;
  line-height: 1.55;

  /* ‚úÖ ÂÖßÂÆπÈÅéÈï∑ÊôÇÂè™ËÆìÈÄôÊ†ºÊç≤Ôºå‰∏çËÆìÊï¥È†ÅÊç≤ */
  max-height: 32vh;
  overflow: auto;
}

/* =========================
   Seats
========================= */
.seats{
  display:flex;
  flex-wrap:wrap;
  gap:10px;
  margin-top: 12px;
}

.seat{
  width: 44px;
  height: 44px;
  border-radius: 999px;
  border: 2px solid rgba(0,0,0,.16);
  background: rgba(255,255,255,.85);
  font-weight: 1000;
}
.seat.selected{
  border-width: 3px;
  border-color: rgba(244,166,58,.95);
  box-shadow: 0 0 0 6px rgba(244,166,58,.15);
}
.seat.dead{
  opacity:.38;
  filter: grayscale(.8);
}
.seat.chief{
  position:relative;
}
.seat.chief::after{
  content:"üëë";
  position:absolute;
  right:-8px;
  top:-10px;
  font-size: 16px;
}
.seat.highlight{
  outline: 3px solid rgba(255,123,123,.75);
  outline-offset: 2px;
}
.seat.disabled{
  opacity:.5;
}

/* =========================
   Day grid
========================= */
.day-grid{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:12px;
  margin-top: 12px;
}

/* =========================
   Tags
========================= */
.tag{
  padding: 6px 10px;
  border-radius: 999px;
  font-weight: 1000;
  background: rgba(244,166,58,.2);
  border: 1px solid rgba(244,166,58,.45);
  color: #3b2a3b;
}

/* =========================
   FAB
========================= */
.fab{
  position: fixed;
  right: 14px;
  width: 54px;
  height: 54px;
  border-radius: 18px;
  border: 2px solid rgba(0,0,0,.12);
  background: rgba(255,255,255,.85);
  font-size: 22px;
  font-weight: 1000;
  box-shadow: 0 12px 26px rgba(0,0,0,.20);
  z-index: 50;
}
.fab-god{ bottom: calc(84px + var(--safeB)); }
.fab-ann{ bottom: calc(20px + var(--safeB)); }

/* =========================
   Modals
========================= */
.modal{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.38);
  display:flex;
  align-items:center;
  justify-content:center;
  padding: 16px;
  z-index: 80;
}
.modal-card{
  width: min(520px, 100%);
  max-height: min(82vh, 720px);
  background: var(--card);
  border-radius: 20px;
  border: 2px solid rgba(225,182,118,.7);
  box-shadow: 0 18px 50px rgba(0,0,0,.28);
  overflow:hidden;
  display:flex;
  flex-direction:column;
}
.modal-card.small{ width: min(360px, 100%); }

.modal-head{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding: 12px 12px;
  border-bottom: 1px dashed rgba(0,0,0,.10);
}
.modal-title{ font-weight: 1000; }
.modal-body{
  padding: 12px 12px;
  overflow: auto;
  min-height:0;
}
.modal-body.center{
  display:flex;
  align-items:center;
  justify-content:center;
}
.modal-actions{
  display:flex;
  gap:10px;
  padding: 12px 12px;
  border-top: 1px dashed rgba(0,0,0,.10);
}

.prebox{
  background: rgba(255,255,255,.70);
  border: 1px dashed rgba(0,0,0,.12);
  border-radius: 14px;
  padding: 10px 10px;
  margin: 10px 0 0;
  white-space: pre-wrap;
  line-height: 1.55;
  max-height: 46vh;
  overflow: auto;
}

/* =========================
   Log List
========================= */
.loglist{ display:flex; flex-direction:column; gap:10px; }
.logitem{
  background: rgba(255,255,255,.65);
  border: 1px dashed rgba(0,0,0,.12);
  border-radius: 14px;
  padding: 10px 10px;
}
.logtitle{ font-weight: 1000; margin-bottom: 6px; }
.logtext{ white-space: pre-wrap; line-height: 1.55; color: var(--ink); }

/* =========================
   PIN / Flip Card
========================= */
.pin{
  width:100%;
  margin-top: 8px;
  padding: 12px 12px;
  border-radius: 14px;
  border: 2px solid rgba(0,0,0,.12);
  font-size: 18px;
  letter-spacing: 8px;
  text-align:center;
}

.flipcard{
  width: 240px;
  height: 300px;
  perspective: 1000px;
}
.flip-inner{
  width:100%;
  height:100%;
  transition: transform .45s ease;
  transform-style: preserve-3d;
}
.flipcard.flipped .flip-inner{ transform: rotateY(180deg); }

.flip-front, .flip-back{
  position:absolute;
  inset:0;
  backface-visibility: hidden;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  border-radius: 20px;
  border: 2px solid rgba(0,0,0,.12);
  background: rgba(255,255,255,.85);
}
.flip-back{
  transform: rotateY(180deg);
  background: rgba(244,166,58,.18);
}
.front-mark{ font-size: 40px; margin-bottom: 8px; }
.rolebig{ font-size: 22px; font-weight: 1000; padding: 10px 12px; }

/* =========================
   God mode hint (optional)
========================= */
body.god-on .topbar{
  background: rgba(55, 20, 60, .06);
}
/* =========================
   Restart Modal polish
========================= */
#modalRestart .modal-card.small{
  max-width: 380px;
}

/* ËÆì modal-actions Âú®ÊâãÊ©üÊõ¥ÂÉè appÔºöÂÖ©È°ÜÊåâÈàïÁñäËµ∑‰æÜÊõ¥Â•ΩÊåâ */
@media (max-width: 420px){
  .modal-actions{
    flex-direction: column;
  }
  .modal-actions .btn{
    width: 100%;
  }
}

/* Primary ÊåâÈàïÂú® modal Ë£°‰∏çË¶ÅÈÅéÂ§ßÈÄ†ÊàêÊì†Â£ì */
.modal-actions .btn.primary{
  width: auto;
  flex: 1 1 auto;
  padding: 12px 14px;
  font-size: 15px;
}

/* ÂèñÊ∂àÈçµÂú® modal Ë£°Êõ¥ÂÉè iOS */
.modal-actions .btn.ghost{
  background: rgba(255,255,255,.82);
}

/* modal ÂÖßÂÆπÈÅéÁü≠ÊôÇÂà•Ë≤ºÈÇä */
#modalRestart .modal-body{
  padding-top: 16px;
  padding-bottom: 16px;
}