<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,maximum-scale=1,user-scalable=no" />
  <meta name="theme-color" content="#f4a63a" />
  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="stylesheet" href="./style.css" />
  <title>狼人殺上帝輔助</title>
</head>
<body>
  <div class="app">
    <!-- Top fixed -->
    <div class="top">
      <div class="topLeft">
        <div id="uiStatus" class="uiStatus">—</div>
        <div id="uiBoard" class="uiBoard">—</div>
      </div>

      <div class="topRight">
        <button type="button" id="btnAnn" class="iconBtn" aria-label="公告">📣</button>
        <button type="button" id="btnTimer" class="iconBtn" aria-label="計時器">⌛️</button>
        <button type="button" id="btnEye" class="iconBtn" aria-label="上帝視角">👁</button>
        <button type="button" id="btnDice" class="iconBtn" aria-label="發言骰子">🎲</button>
        <button type="button" id="btnSettings" class="iconBtn" aria-label="設定">⚙️</button>
      </div>
    </div>

    <!-- Main content: Prompt + Seats -->
    <div class="main">
      <!-- Prompt card -->
      <section class="card promptCard">
        <div class="cardTitle" id="promptTitle">—</div>
        <pre class="cardText scrollBox" id="promptText">—</pre>
        <div class="cardFoot" id="promptFoot"></div>
      </section>

      <!-- Setup card (only in setup) -->
      <section id="setupCard" class="card setupCard">
        <div class="cardTitle">開局設定</div>

        <div class="hint" style="margin:8px 0 6px;">人數</div>
        <div class="chips">
          <button type="button" class="chip" data-n="9">9</button>
          <button type="button" class="chip" data-n="10">10</button>
          <button type="button" class="chip" data-n="12">12</button>
        </div>

        <div class="hint" id="boardHint" style="margin:10px 0 6px;">請選擇板子（點一下會變色）</div>
        <div id="boardList" class="boardList"></div>

        <div class="hint" style="margin-top:10px;">
          選完後按底部「下一步」進入抽身分。
        </div>
      </section>

      <!-- Seats -->
      <section id="seatsHeader" class="card tight seatsHeader">
        <div class="row">
          <div class="cardTitle">座位</div>
          <div class="hint">點一下選取；再點一次取消選取</div>
        </div>
      </section>
      <section id="seatsGrid" class="seatsGrid"></section>
    </div>

    <!-- Bottom fixed action bar -->
    <div class="bottomBar">
      <button type="button" id="btnBack" class="btn ghost">上一步</button>
      <button type="button" id="btnMain" class="btn main">天亮睜眼</button>
      <button type="button" id="btnNext" class="btn">下一步</button>
    </div>
  </div>

  <!-- ======== Drawer: Timer ======== -->
  <div id="timerBackdrop" class="backdrop hidden"></div>
  <div id="timerDrawer" class="drawer hidden" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="drawerTop">
      <div class="drawerTitle">⌛️ 計時器</div>
      <button type="button" id="btnCloseTimer" class="iconBtn" aria-label="關閉">✕</button>
    </div>
    <div class="drawerBody">
      <div class="timerBig" id="timerBig">01:30</div>

      <div class="hint" style="margin:8px 0 6px;">快速設定</div>
      <div id="timerPresets" class="chips" style="flex-wrap:wrap;">
        <button type="button" class="chip" data-sec="30">30秒</button>
        <button type="button" class="chip" data-sec="60">1分鐘</button>
        <button type="button" class="chip" data-sec="90">1分半</button>
        <button type="button" class="chip" data-sec="120">2分鐘</button>
        <button type="button" class="chip" data-sec="180">3分鐘</button>
        <button type="button" class="chip" data-sec="300">5分鐘</button>
      </div>

      <div class="seg" style="margin-top:10px;">
        <button type="button" class="segBtn primary" id="btnTimerStart">開始</button>
        <button type="button" class="segBtn" id="btnTimerPause">暫停</button>
        <button type="button" class="segBtn" id="btnTimerReset">重置</button>
      </div>
    </div>
  </div>

  <!-- ======== Drawer: Announce ======== -->
  <div id="annBackdrop" class="backdrop hidden"></div>
  <div id="annDrawer" class="drawer hidden" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="drawerTop">
      <div class="drawerTitle">📣 公告</div>
      <button type="button" id="btnCloseAnn" class="iconBtn" aria-label="關閉">✕</button>
    </div>
    <div class="drawerBody">
      <label class="row" style="margin:0 0 10px;">
        <span>顯示上帝詳細</span>
        <input id="toggleAnnGod" type="checkbox" />
      </label>
      <pre id="annText" class="cardText" style="white-space:pre-wrap; margin:0;"></pre>
    </div>
  </div>

  <!-- ======== Drawer: Settings ======== -->
  <div id="setBackdrop" class="backdrop hidden"></div>
  <div id="setDrawer" class="drawer hidden" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="drawerTop">
      <div class="drawerTitle">⚙️ 設定</div>
      <button type="button" id="btnCloseSet" class="iconBtn" aria-label="關閉">✕</button>
    </div>
    <div class="drawerBody">
      <div class="hint" style="margin-bottom:6px;">勝負模式</div>
      <div class="seg">
        <button type="button" id="segEdge" class="segBtn">屠邊</button>
        <button type="button" id="segCity" class="segBtn">屠城</button>
      </div>

      <label class="row" style="margin-top:10px;">
        <span>上警</span>
        <input id="togglePolice" type="checkbox" />
      </label>

      <div class="hint" style="margin-top:12px;">開局/結束</div>
      <button type="button" id="btnGotoSetup" class="btn ghost" style="width:100%; margin-top:6px;">
        回到開局（重選人數/板子）
      </button>
      <button type="button" id="btnHardReset" class="btn ghost" style="width:100%; margin-top:8px;">
        清空資料（硬重置）
      </button>
    </div>
  </div>

  <!-- ======== Modal: Role ======== -->
  <div id="roleModal" class="modal hidden" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modalCard">
      <div class="modalTitle" id="roleModalTitle">—</div>
      <div class="modalBody">
        <div class="roleLine" id="roleModalRole">—</div>
        <div class="roleLine small" id="roleModalCamp">—</div>
        <div class="hint" style="margin-top:10px;">看完請把手機交回上帝</div>
      </div>
      <div class="modalActions">
        <button type="button" id="btnRoleDone" class="btn">我看完了</button>
        <button type="button" id="btnRoleClose" class="btn ghost">關閉</button>
      </div>
    </div>
  </div>

  <!-- ======== Modal: Dice ======== -->
  <div id="diceModal" class="modal hidden" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modalCard">
      <div class="modalTitle">🎲 今日發言順序</div>
      <div class="modalBody">
        <div id="diceResult" class="diceResult">—</div>
        <div class="hint" style="margin-top:10px;">（只會從「存活座位」隨機抽）</div>
      </div>
      <div class="modalActions">
        <button type="button" id="btnDiceAgain" class="btn">再擲一次</button>
        <button type="button" id="btnDiceClose" class="btn ghost">關閉</button>
      </div>
    </div>
  </div>

  <!-- ======== Modal: Thief choose ======== -->
  <div id="thiefModal" class="modal hidden" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modalCard">
      <div class="modalTitle">🃏 盜賊選角</div>
      <div class="modalBody">
        <div class="hint" id="thiefHint" style="margin-bottom:10px;"></div>

        <div class="card mini" style="margin:0;">
          <div class="cardTitle" style="font-size:16px;">可選兩張牌（從「未被抽到」的角色）</div>
          <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:10px;">
            <button type="button" id="btnThiefA" class="btn"></button>
            <button type="button" id="btnThiefB" class="btn"></button>
          </div>
          <div class="hint" style="margin-top:10px;">
            選完後會立刻成為該角色（另一張視為被捨棄）。
          </div>
        </div>
      </div>

      <div class="modalActions">
        <button type="button" id="btnThiefClose" class="btn ghost">關閉</button>
      </div>
    </div>
  </div>

  <script src="./app.js"></script>
</body>
</html>