<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>ç‹¼äººæ®ºä¸Šå¸è¼”åŠ©</title>

  <!-- æ‰‹æ©Ÿè¨­å®š -->
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#3b2f2f" />

  <!-- PWA -->
  <link rel="manifest" href="./manifest.webmanifest" />

  <!-- æ¨£å¼ -->
  <link rel="stylesheet" href="./style.css" />
</head>
<body>

<div class="app">

  <!-- ===== Header ===== -->
  <header class="top-bar">
    <h1>ğŸº ç‹¼äººæ®ºä¸Šå¸</h1>
    <button id="godToggle" onclick="toggleGodMode()">ğŸ”’</button>
  </header>

  <!-- ===== ä¸»å…§å®¹å€ ===== -->
  <main id="main" class="main">
    <h2>è«‹é¸æ“‡æ¿å­é–‹å§‹éŠæˆ²</h2>
    <p style="opacity:.7;font-size:14px">
      ä¸Šå¸æ¨¡å¼å¯æŸ¥çœ‹èº«åˆ†èˆ‡æ“ä½œå¤œæ™šæµç¨‹
    </p>
  </main>

  <!-- ===== Footer ===== -->
  <footer class="bottom-bar">
    <button onclick="showRoleBook()">ğŸ“– è§’è‰²åœ–é‘‘</button>
    <button onclick="showLogs()">ğŸ“œ ç´€éŒ„</button>
  </footer>

</div>

<!-- =====================
     ä¸Šå¸æ¨¡å¼ PIN
===================== -->
<div id="godLock" class="modal hidden">
  <div class="modal-card">
    <h3>ğŸ‘ï¸ ä¸Šå¸æ¨¡å¼</h3>
    <p>è«‹è¼¸å…¥ PIN</p>
    <input type="password" id="godPin" placeholder="é è¨­ 1234" />
    <button onclick="unlockGod()">è§£é–</button>
  </div>
</div>

<!-- =====================
     è§’è‰²åœ–é‘‘
===================== -->
<div id="roleBook" class="modal hidden">
  <div class="modal-card scroll">
    <h3>ğŸ“– è§’è‰²åœ–é‘‘</h3>
    <div id="roleList"></div>
    <button onclick="closeRoleBook()">é—œé–‰</button>
  </div>
</div>

<!-- =====================
     ç´€éŒ„
===================== -->
<div id="logModal" class="modal hidden">
  <div class="modal-card scroll">
    <h3>ğŸ“œ éŠæˆ²ç´€éŒ„</h3>
    <div id="logList"></div>
    <button onclick="closeLogs()">é—œé–‰</button>
  </div>
</div>

<!-- =====================
     ä¸»ç¨‹å¼
===================== -->
<script type="module" src="./app.js"></script>

<!-- =====================
     UI / ä¸Šå¸æ¨¡å¼æ§åˆ¶
===================== -->
<script type="module">
import ROLES from "./roles.js";

/* ===== ä¸Šå¸æ¨¡å¼ ===== */
let godMode = false;
const GOD_PIN = "1234";

window.toggleGodMode = function () {
  if (!godMode) {
    document.getElementById("godLock").classList.remove("hidden");
  } else {
    godMode = false;
    document.getElementById("godToggle").innerText = "ğŸ”’";
    document.body.classList.remove("god");
  }
};

window.unlockGod = function () {
  const pin = document.getElementById("godPin").value;
  if (pin === GOD_PIN) {
    godMode = true;
    document.getElementById("godToggle").innerText = "ğŸ‘ï¸";
    document.body.classList.add("god");
    document.getElementById("godLock").classList.add("hidden");
    document.getElementById("godPin").value = "";
  } else {
    alert("PIN éŒ¯èª¤");
  }
};

/* ===== è§’è‰²åœ–é‘‘ ===== */
window.showRoleBook = function () {
  const list = document.getElementById("roleList");
  list.innerHTML = Object.values(ROLES)
    .map(r => `
      <div class="card">
        <h4>${r.name}</h4>
        <p>${r.skill}</p>
        ${godMode ? `<small style="opacity:.6">${r.godNote}</small>` : ""}
      </div>
    `)
    .join("");
  document.getElementById("roleBook").classList.remove("hidden");
};

window.closeRoleBook = function () {
  document.getElementById("roleBook").classList.add("hidden");
};

/* ===== ç´€éŒ„ ===== */
window.showLogs = function () {
  const list = document.getElementById("logList");
  list.innerHTML = (window.Game?.logs || [])
    .map(l => `<p>â€¢ ${l}</p>`)
    .join("");
  document.getElementById("logModal").classList.remove("hidden");
};

window.closeLogs = function () {
  document.getElementById("logModal").classList.add("hidden");
};
</script>

<!-- =====================
     PWA Service Worker
===================== -->
<script>
if ("serviceWorker" in navigator) {
  window.addEventListener("load", () => {
    navigator.serviceWorker.register("./sw.js");
  });
}
</script>

</body>
</html>
